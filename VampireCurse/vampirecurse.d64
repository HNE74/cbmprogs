KKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKK
S$,(ES$)1) 1 4510 1] *** QUIT *** 1] "COWARD! YOU HAVE QUIT THE GAME." -2] "NOW THE VAMPIRE'S CURSE WILL PREVAIL." O2]: "YOUR FINAL SCORE IS:";SC i2]: "[PRESS ANY KEY]" 2] 198,0: 198,1: 198,0:WT0 2] 2a *** PRINT WORLD ***(166);(166) 5Mb 5c *** SHOW INVENTORY *** 	6cWT4000: "YOU'RE CARRYING THE FOLLOWING ITEMS:" 6cJ0: I04 66c OI(I)1  WO$(I):J1 <6c T6c J0   "NOTHING" Z6c z6e *** SHOW INSTRUCTIONS *** 6e "IF YOU DON'T STAKE THE VAMPIRE NORTH, SOUTH, WEST OR EAST." 7f "THE DIRECTION CAN BE ABBREVIATED BY" 7f "N, S, W OR E." (8f "EXAMPLE: ";(34);"GO NORTH";(34) X8f "FOR TAKING AN ITEM ENTER TAKE AND THEN" o8!f "THE ITEM NAME." 8&f "EXAMPLE: ";(34);"TAKE KNIFE";(34) 8+1:198,0 9Df "ONLY THE CRUCIFIX PROTECTS YOU FROM THE" :If "VAMPIRE. FOR BANNING THE VAMPIRE TO" :Nf "HIS COFFIN ENTER:" M:Sf (34);"ATTACK VAMPIRE WITH CRUCIFIX";(34) ~:Xf "THE VAMPIRE MUST BE STAKED WITH A SHARP" :]f "POLE OF WOOD USING TE'S COFFIN OR A" ;f "CHEST ENTER FOR EXAMPLE: ";(34);"OPEN COFFIN";(34) <f "[PRESS ANY KEY]":198,0:198,1:198,0 J<f "USE THE ";(34);"INVENTORY";(34)" COMMAND TO" u<f "CHECK WHICH ITEMS YOU'RE CARRYING." <f "THE ";(34);"MAP";(34);]":198,0:198,1:198,0:WT0 =f =xi *** INTRO SCREEN *** =zi 53280,12: 53281,15 	>}i "                " ,>i "                 '" O>i "                      " t>i "        :                " >i "          CURSE OF       '             " ?i "                 :    " ?i "              .        " #@i "       ',    L:  ::        " I@i "        '    !\        " n@i "                       " @i "                    198,0: 26000: 27000 Ai A$(32)  198,0: 320 Ai 27120 A0u *** VOCABULARY *** B5u I0VC1: WV$(I):: 30020 :B:u "GO","TAKE","ATTACK","SHARPEN","OPEN","STAKE" \BDu I0OC1: WO$(I):: 30030 BIu "KNIFE","GUN","AMMO","CRUCIFIX","POLE", A" Clu I0NC1: WN$(I):: Cqu "THE", "WITH", "TO", "OF"   K 2aXP1:YP1:RP0 2a Y0WH: X0WW 2a 25100 3aRPRP1:XPXP3:X:XP1:YPYP3:Y "3a214,YP1:211,0:58640 U3a " [PRESS ANY KEY]":198,0:198,1:198,0:WT0 [3a p3b *** PRINT ROOM 3b RA(RP,8)1  25150 3b214,YP:211,XP:58640: 0:" " 4*b RA(RP,5)0  214,YP1:211,XP:58640:" " 5/b RA(RP,7)0  214,YP1:211,XP2:58640:" " 54b H5>b214,YP:211,XP:58640: (166);(166);(166) |5Cb214,YP1:211,XP:58640: (166);(166);(166) 5Hb214,YP2:211,XP:58640: (166); BEFORE" 6e "MIDNIGHT HE WILL ESCAPE AND YOU HAVE" 7e "LOST. BEWARE OF HIS EVIL SERVANTS:" 17e "RAT, SPIDER AND WOLF. THEY MIGHT KNOCK" `7e "YOU OUT AND YOU'LL LOSE PRECIOUS TIME." 7e "TO MOVE AROUND TYPE GO AND QUOTE THE" 7f "DIRECTION:f "YOU CAN ATTACK THE VAMPIRE'S" 80f "CREATURES BY ENTERING ATTACK FOLLOWED" 95f "BY THEIR NAME. IF YOU CARRY A WEAPON" B9:f "QUOTE IT AT THE COMMAND'S END." v9?f "EXAMPLE: ";(34);"ATTACK RAT WITH GUN";(34) 9Bf "[PRESS ANY KEY]":198,0:198,HE COMMAND:" :bf (34);"STAKE VAMPIRE WITH POLE";(34)  ;gf "PRERQUISITE IS THAT YOU OWN THE POLE" -;lf "AND HAVE SHARPENED IT USING A KNIFE." Q;qf "FOR THIS ENTER THE COMMAND:" };f (34);"SHARPEN POLE WITH KNIFE";(34) ;f "TO OPEN THE VAMPIR" COMMAND DRAWS" <f "A MAP OF THE ROOMS YOU HAVE EXPLORED." =f "";(34);"HELP";(34);" PRINTS THESE INSTRUCTIONS" =f "AGAIN." K=f "IF YOU WANT TO EXIT THE CURRENT GAME" }=f "ENTER THE ";(34);"QUIT";(34);" COMMAND." =f "[PRESS ANY KEY      " >i "                       ," >i "             THE VAMPIRE'" ?i "                        " 4?i "               BY NOLTISOFT" Z?i "                        " ?i "               CREATED IN 2021" ?i "   ," @i "           K     .    " @i "             '  |        " Ai "             { :        " ;Ai "      PRESS [SPACE] TO START" bAi "          [I] FOR INSTRUCTIONS" {Ai A$: A$""  27120 Ai A$"I"  "COFFIN","CHEST","ALTAR" BNu I0DC1: WD$(I):: 30040 BSu "NORTH","N","SOUTH","S","WEST","W","EAST", "E" CXu I0CC1: WC$(I):: 30050 AC]u "RAT","SPIDER","WOLF","VAMPIRE" cCbu I0IC1: WI$(I):: 30060 Cgu "INVENTORY","HELP","MAP","QUITK(111);(247);(112) 3b214,YP1:211,XP:58640: (165); 4b RPPR  "*";(167):25115 4b" ";(167) H4b214,YP2:211,XP:58640: (108);(175);(186) y4 b RA(RP,1)0  214,YP:211,XP1:58640:" " 4%b RA(RP,3)0  214,YP2:211,XP1:5864
LD OUTPUT ***   "YOU ARE IN ROOM:";PR %T$(TH)":": TM10  T$T$"0" CT$T$((TM),((TM))1) [ "THE TIME IS:";T$  "CURRENT SCORE:";SC:RA(PR,8)1: PD$"": I172  RA(PR,I)1I1PD$PD$"NORTH,"  RA(PR,I)1I3P& "AN AGGRESSIVE RAT ATTACKS YOU.":3800:3195 8!+ "A GIANT SPIDER SPILLS IT'S VENOM.":3800:3195 s!0 "YOU ARE ATTACKED BY A RED EYED WOLF.":3800:3195 !5 "THE VAMPIRE IS APPROACHING YOU.":3800 !{ ! *** PLAYER MOVE *** ! RAD17 PM6: "GOING EAST...":3335 # RA(PR,PM1)1   "YOU CAN'T GO THERE.": 5#PRRA(PR,PM):WT1000 ;# U#H *** PLAYER INFO *** i#M I10  25500 }#R I11  26000 #W I12 "": 25000 #\ I13 QT1: 24000 #a # *** TAKE OBJ*** $ RA(PR,10)C1  "HERE IS NO ";WC$(C1);".": 6% O11   OI(O1)1  "YOU HAVE NO ";WO$(O1);".": a% O12  "USE A GUN WITH THE AMMO.": %$ O11   OI(2)1   "YOU NEED AMMO FOR THE GUN.": %) O13   C13   "THE CRUCIFIX RA(PR,10)1: "YOU HAVE HIT THE ";WC$(C1);".":SCSC10 '[OP((1)(WW1)(WH1)) 8'`RA(OP,10)1  PROP  3675 I'eRA(OP,10)C1 O'j l't *** VAMPIRE BANNED *** 'y "YOU HAVE BANNED THE VAMPIRE." '~ "NOW GET HIM SLEEPING IN HIS COFFIN" 'E VAMPIRE.": ( C12 AF3: 3830 ( C11 AF4: 3830 ) C10 AF5: 3830 N) ((1)AF)0   "THE ";WC$(C1);" HAS MISSED YOU.": x) "THE ";WC$(C1);" HAS HIT YOU HARD." ) "YOU HAVE PASSED OUT"; )I02:".";:J0500:J:I: ) )1  VB(1)1: "IN THE COFFIN IS THE SLEEPING VAMPIRE.": $+K O15  VB(1)1: "THE COFFIN IS EMPTY.": |+P ((1)2)0   "THE CRUMBLING CHEST REVEALS A TREASURE.":SCSC100:RA(PR,9)1: +U "THE CRUMBLING CHEST REVEALS AN":RA(PR,9)1 +Z "I , OI(0)1   "YOU KNEED A KNIFE TO SHARPEN THE POLE.": /- OI(4)1  B11   "SHARPEN THE POLE BY WHICH?": u- OI(4)1  B10   "YOU CAN'T USE THE ";WO$(B1);" FOR THIS.": -VB(2)1: "YOU HAVE SHARPENED THE POLE." - - *** SCONGRATULATIONS, YOU HAVE BEATEN" .w "THE VAMPIRE.":SCSC(23TH)6060TM ./z "REMAINING TIME BONUS:";(23TH)6060TM 9/| 4250 `/ "YOU HAVE LOST, THE VAMPIRE HAS" {/ "MANAGED TO ESCAPE." /: "YOUR FINAL SCORE IS:";SC /: "[PRESS AN    ES$""  ES$OA$: "";ES$;(CS);"": 0 I13  OA$ES$: 
1 I32  4545: SPACE (1 I20  4560: BACKSPACE A1 I65  I90  4510 W1 (20);A$;(CS); f1ES$ES$A$ q1 4510 1 (ES$)0  4510 1 (20);(20);(CS); 1ES$(ED$PD$"SOUTH,"  RA(PR,I)1I5PD$PD$"WEST," - RA(PR,I)1I7PD$PD$"EAST," G:PD$(PD$,(PD$)1)  *** OBJECTS: KNIFE, GUN, AMUNITION, CRUCIFIX, POLE, COFFIN, CHEST, ALTAR  RA(PR,9)13095  RA(PR,9)1  3045,3050,3055,30VER A POLE OF WOOD.":3095   "A SCARY OLD COFFIN IS IN THE ROOM.":3095 I  "THERE IS A CHEST IN THE CORNER.":3095 p  "THERE IS AN EMPTY DUSTY ALTAR."   "YOU CAN GO ";PD$:   RA(PR,10)1 3195  ! RA(PR,10)1  3110,3115,3120,3125  !(PR,10)3   OI(3)1   3315 2" RA(PR,10)1   "THE ";WC$(RA(PR,10));" DOESN'T LET YOU PASS.": a" D10D11 PM0: "GOING NORTH...":3335 " D12D13 PM2: "GOING SOUTH...":3335 " D14D15 PM4: "GOING WEST...":3335 " D16ECT *** # O10   O14  3520 $ "YOU CAN'T TAKE THE ";WO$(O1);".": I$ RA(PR,9)O1   "HERE IS NO ";WO$(O1);".": q$ "YOU HAVE TAKEN THE ";WO$(O1);"." ~$OI(O1)1 $ O13  RA(PR,9)7: $RA(PR,9)1: $ *** ATTACK CHARACTER IS USELESS.": ,&. O13   C13   "THIS IS USELESS.": "YOU NEED A CRUCIFIX TO BAN THE VAMPIRE.": G&3 O13   C13  3700 ^&BAF5: O11  AF2 p&G O10  AF3 &L O14  AF4 &Q ((1)AF)0   "YOU HAVE MISSED THE ";WC$(C1);".": &V "AND STAKE HIM WITH A SHARPENED POLE." (VB(0)1:RA(PR,10)1:SCSC20:VB(1)1:WT4000 "( H( *** PLAYER HARMED BY ATTACK *** Y(C1RA(PR,10) ~( C13  OI(3)1  AF2: 3830 ( C13  OI(3)1   "THE CRUCIFIX PROTECTS YOU FROM":"THTMTM10: TM60  THTH1:TMTM60: TH23  VB(3)2 *
OP((1)(WW1)(WH1)) 0*RA(OP,10)1  PROP  3850 N*RA(OP,10)C1:RA(PR,10)1 T*7 n*< *** OPEN OBJECT *** *A O15O16   "YOU CAN'T OPEN THE ";WO$(O1);".": *F O15   VB(0NSIDIOUS TRAP. YOU HAVE PASSED OUT"; +_I02:".";:J01000:J:I: :,aTMTM10: TM60  THTH1:TMTM60: TH23  VB(3)2 @,d [, *** SHARPEN POLE *** , O14   "YOU CAN'T DO THIS.": , OI(4)1   "YOU'RE NOT CARRYING ANY POLE.":TAKE VAMPIRE *** -	VB(1)1   "THE COFFIN IS CLOSED.": 5.RA(PR,9)5VB(0)1   "THERE IS NO SLEEPING VAMPIRE HERE.": l.VB(2)1O14   "YOU NEED A SHARPENED POLE.": z.VB(3)1: .h *** GAME END *** .m: VB(3)2   4225 .r "	Y KEY]" / 198,0: 198,1: 198,0 / /0 *** TIME INCREASE *** 05TMTM1 !0: TM60  TMTM60:THTH1 70? TH23  VB(3)2 =0D Y0 *** INPUT ROUTINE *** 0ES$"": "ENTER COMMAND> ";(CS); 0 A$: A$""  4510 0I(A$) 0 I1360,3065,3070,3075,3080  "YOU SEE A KNIFE LYING ON THE GROUND.":3095 P "YOU RECOGNIZE A GUN THAT SOMEONE LOST.":3095  "YOU SEE AMMO SCATTERED ON THE GROUND.":3095  "THERE IS A DUSTY ALTAR WITH A CRUCIFIX.":3095  "YOU STUMBLED O
2
  *** WORD RECOGNITION ROUTINE VARIABLES *** u ES$"":WC$"":WS10: W$(WS): WW$(WS): *** INPUT PARSER VARS   *** VOCABULARY: VERBS, OBJECTS, OBJECT2, DIRECTION, CHARACTER, INFO, IGNORED  VC6:OC8:DC8:CC4:IC4:NC4  	  WV$(VC): WO$R0:AR0: *** DIRECTION INDEX, ADJACENT ROOM INDEX a  *** INVENTORY: KNIFE, GUN, AMMO, CRUCIFIX, POLE n  OI(5):   *** GAME VARIABLES ***  PR0:PD$"": PLAYER ROOM, PLAYER DIRECTIONS, PLAYER COMMAND  PM0: PLAYER MOVEMENT NDX  OP1:QUIT , 30000: INIT VOCABULARY /6 27000: SHOW TITLE D@ A$(32)  400 NE 310 l *** INIT GAME STATE *** zSC0:PR0 I03:VB(I)1:: VAMPIRE RELATED STATE  I04:OI(I)1:: INVENTORY TH22:TM00  *** WORLD CREATILAYER WORLD OUTPUT _ VB(3)1  630 1b 4500: PLAYER INPUT Ug 1800: RECOGNIZE PLAYER INPUT mi QT1  QT0: 310 l 4400: INCREASE TIME q VB(3)1  600 v 4200: 310  *** INITIALIZE WORLD ***  RP0RC RA(RP,0)RPWWRA(RP,4)1:RP % RPWW  RC  (WW1):RA(RP,6)1:RP IOP(0)3:OP(2)1:OP(4)7:OP(6)5 O oL *** CONNECT ALL ROOMS *** QBP0:RP0:DR(TI) VRA(RP,8)1:DR((1)4)22:DF1 [DFDF1:DRDR2:DR6DR0 ` DF31170 e *** CHEECOMES CURRENT RPRA(RP,DR):1110  BP01185 B *** BACKTRACK TO PREVIOUS ROOM rRPBR(BP):DRBD(BP):DFBC(BP):BPBP1:1115 x  *** PUT OBJECTS ***  I0OC2 OP((1)(WW1)(WH1)) RA(OP,9)11210 RA(OP,9)I WW1)(WH1)) DR((1)4)2 ? RA(RP,DR)1  RA(RP,DR1)0:RA(RA(RP,DR),OP(DR))0 E K i *** EVALUATION LOOP *** t 2000  2100:WT2000:  WU$""  "I DON'T UNDERSTAND THE WORD: ";WU$: I01000:: & WP$"VD"WP$"O"   V12   3600:1900: ATTACK CHARACTER AI WP$"VO"  V14   3900:1900: OPEN OBJECT N WP$"VO"WP$"VOB"  V13   4000:1900: SHARPEN POLE S WP$"VCO"  V15   4100:1900: STAKE VAMPIRE X "I DON'T UNDERSTAND ANYTHING."  *** 9WP1:WU$"":WP$"":V11:O11:B11:D11:C11:I11 3> I0WI:WF0:WN0 oC J0VC1: WV$(J)W$(I) V1J:WF1:JVC1:WP$WP$"V" wH J M WF1 2200 P O11   2141 R J0OC1: WO$(J)W$(I) O1J:WF1:JOC1:WP$WP$"O" " u J z J0IC1: WI$(J)W$(I) I1J:WF1:JIC1:WP$WP$"I" % J 6 WF1 2200 a J0NC1: WN$(J)W$(I) WN1:JNC1 i J  WF0WN0 WU$W$(I):IWI: 2205  WF1  WPWP1:WW$(WP)W$(I)  I   *** PLAYER WOR(OC): WD$(DC): WC$(CC): WN$(NC) H	# V11:O11:B11:D11:C11:I11 	( WP0:WF0:WN0: *** INPUT CHECK VARS: POINTER, WORD FOUND, WORD IGORED 	- WU$"":WP$"": *** UNKNOWN WORD, WORD RECOGNITION PATTERN 	d  *** WORLD VARIABLES *** #
i  OPENOUNT #}  OP(7): *** OPPOSITE ROOM SLOT = BP0:  STACK POINTER g  BR((WW1)(WH1)):  *** ROOM STACK   BD((WW1)(WH1)):  *** DIRECTION STACK   BC((WW1)(WH1)):  *** COUNTER STACK  XP0:YP0:X0:Y0: *** COORDINATE COUNTER + D OBJECT ROOM  AF1: ATTACK FACTOR a  VB(4): BANNED FLAG, COFFIN OPEN, POLE SHARPENED, STAKED FLAG y SC0: PLAYER SCORE  TH0:TM0: TIME HOURS, MINUTES  WT2000: WAIT TIME  A$"":OA$"":CS166: INPUT ROUTINE  QT0: PLAYER HAS ON *** & "DESCENDING INTO THE VAMPIRE'S CRYPT." > 1000: INIT WORLD Y 1100: CONNECT ROOMS t 1200: PLACE OBJECTS  1300: SET ROOMS UNVISITED  1400: ADDITIONAL ROOM CONNECTIONS X *** GAME LOOP *** [ "" ] 3000: P1:RA(RP,1)1:RA(RP,2)RPWW1:RA(RP,3)1 XRA(RP,4)RP1:RA(RP,5)1:RA(RP,6)RP1:RA(RP,7)1:RA(RP,8)0 uRA(RP,9)1:RA(RP,10)1 }RP  RP0  WW:RA(RP,0)1:RP  RPWH(WW1)  (WW1)(WH1)1:RA(RP,2)1:RP  RP0  RC  (WW1):CK ADJACENT ROOM CONNECTABLE j RA(RP,DR)11115 ;o RA(RA(RP,DR),8)11115 [t *** CONNECT ADJACENT ROOM yRA(RP,DR1)0:RA(RA(RP,DR),OP(DR))0 ~ *** CURRENT ROOM ON STACK BR(BP)RP:BD(BP)DR:BC(BP)DF:BPBP1  *** ADJACENT ROOM B  I0CC1 OP((1)(WW1)(WH1)) ,RA(OP,10)11235 <RA(OP,10)I B H m *** SET ROOMS TO UNVISITED ***  I0(WW1)(WH1)1:RA(I,8)1:  x *** CREATE RANDOM ROOM CONNECTIONS *** } I010 RP((1)(VO"WP$"VOB"WP$"VC"WP$"VCO"WP$"I" 1845 @+ "THIS DOESN'T MAKE SENSE.": I01000:: k5 WP$"VD"  3300:1900: PLAYER MOVE : WP$"I"  3400:1900: PLAYER INFO ? WP$"VO"  V11   3500:1900: TAKE OBJECT D WP$"VC"WP$"VCl I0WT::  *** INPUT PARSER *** (WI0: I0WS1:W$(I)"":I 9 I1(ES$) LWC$(ES$,I,1) g I1  WC$" "  2035  WC$" "  W$(WI)W$(WI)WC$: 2035  (ES$,I1,1)" "  WIWI1  I  4 *** WORD RECOGNITION	 W J \ WF1 2200 /] J0OC1: WO$(J)W$(I) B1J:WF1:JOC1:WP$WP$"B" 7^ J H_ WF1 2200 a J0DC1: WD$(J)W$(I) D1J:WF1:JDC1:WP$WP$"D" f J k WF1 2200 p J0CC1: WC$(J)W$(I) C1J:WF1:JCC1:WP$WP$"C WALL=0, WALL=1, NOT ACCESSABLE ROOM=-1 H
n WW5:WH4: *** WORLD DIMENSIONS 
p  *** 0-7 ROOM AND WALL, 8 VISITED, 9 OBJECT, 10 CHARACTER 
s  RA(((WW1)(WH1)1),10): *** ROOM ADJACENT MATRIX 
x RP0:RC((WW1)(WH1)1): *** ROOM POINTER, ROOM CA          2A                                                                                       VAMPIRECURSE         =                                                                                                                                                                                                                                 KKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKK